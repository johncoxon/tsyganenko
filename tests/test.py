"""
test.py
"""
import unittest
from tsyganenko import tsygTrace

class tsygTraceTestCase(unittest.TestCase):
    def test_footprint(self):
        expected_latNH = np.array([79.0975367873834, 79.1150861046821, 79.13261407763964,
                                   79.15011558361417,79.16756159430167,79.1849990672527,
                                   79.20623241783498,79.22743161747141,79.2485744680472,
                                   79.2696848752244, 79.29076027768212,79.32463886973903,
                                   79.35843293820497,79.39212113873876,79.42572310813429,
                                   79.45923030865508,79.49167882985451,79.52400953029077,
                                   79.55626339109887,79.58846517171453,79.62063621647894,
                                   79.64983356763345,79.67896261689626,79.70798579822694,
                                   79.73710545597964,79.76594422220273,79.79774985184653,
                                   79.82948461827772,79.86128256395871,79.89276546716424,
                                   79.92413737979575,79.96224044385431,80.00034265413923,
                                   80.03793516155733,80.07534752273608,80.11248155370615,
                                   80.14927236767042,80.18549883725451,80.22142563228878,
                                   80.2571483754216, 80.29291380723672,80.33390945640879,
                                   80.3746421432978, 80.41507771695792,80.45565245572239,
                                   80.49548953405649,80.53638870680652,80.57698393613849,
                                   80.61772174566939,80.65763907872623,80.69721660987187])
                                   
        expected_lonNH = np.array([327.0792905203949,327.11182954160086,327.14455980810357,327.17731739536293,327.1929995096973,327.2259210214968,327.2786500818893,327.3315703875785,327.36738789958605,327.4205814128421,327.47385688836823,327.60485991664905,327.7191699625984,327.8517575947667,327.9851375288787,328.1195010102312,328.25886419005616,328.4169694089636,328.57619477889494,328.73651297909345,328.87989231015035,329.0428606237469,329.2067578430705,329.37180253417466,329.5191980164636,329.6862371228054,329.8651061167897,330.04501329952785,330.2073532357207,330.38963732429,330.5730415638832,330.8323428655335,331.0745140527455,331.337558298061,331.6022964302907,331.8689743362447,332.1197515618109,332.3916477322908,332.6653197519548,332.94052173399297,333.1980471864592,333.48906788661503,333.7822469265487,334.0777209100434,334.35540908093947,334.6553090270164,334.9713008987779,335.2897789593972,335.59058049044455,335.91405824953637,336.2400768389994])
        
        expected_rhoNH = np.array([6371.199620246887,6371.199240493775,6371.199240493775,6371.198860740661,6371.199240493775,6371.198860740661,6371.198860740661,6371.1984809875485,6371.199240493775,6371.1984809875485,6371.198860740661,6371.198860740661,6371.199240493775,6371.199240493775,6371.198860740661,6371.199240493775,6371.1984809875485,6371.198860740661,6371.199620246887,6371.1984809875485,6371.198860740661,6371.198860740661,6371.199240493775,6371.199240493775,6371.198860740661,6371.1984809875485,6371.199240493775,6371.199240493775,6371.1984809875485,6371.199620246887,6371.198860740661,6371.199620246887,6371.199620246887,6371.1984809875485,6371.198860740661,6371.199240493775,6371.199240493775,6371.1984809875485,6371.199240493775,6371.1984809875485,6371.199240493775,6371.199240493775,6371.199620246887,6371.198860740661,6371.1984809875485,6371.199240493775,6371.199240493775,6371.199620246887,6371.199620246887,6371.199620246887,6371.199620246887])
                                   
        expected_latSH = np.array([34.24096182375177,34.253549862392106,34.26583737270896,
                                   34.27775263771604,34.229019237988005,34.24163118229043,
                                   34.25304101329894,34.264129825416454,34.214518746380065,
                                   34.22627008684707,34.237731144274356,34.248317937487876,
                                   34.19807506595326,34.209286821475835,34.220146822256154,
                                   34.230767766415525,34.18006044201735,34.190879461662654,
                                   34.201377462416964,34.211598840509886,34.16111691235432,
                                   34.171864215013336,34.18221536670049,34.1923035561046,
                                   34.14176698643568,34.15256210041888,34.162230233189035,
                                   34.17160808291946,34.1204875320765,34.13059962714271,
                                   34.140377042939576,34.14955681718408,34.098367964449416,
                                   34.10831613497554,34.117970607367354,34.12725624954398,
                                   34.07637134022739,34.086507340955684,34.09633939826592,
                                   34.1058640970635,34.055153357570745,34.06346569779065,
                                   34.07143994364664,34.07916830269251,34.026831978177285,
                                   34.035325318410194,34.04316296048279,34.05076496102901,
                                   33.99844571198671,34.00678195786871,34.01480743014348])
        
        expected_lonSH = np.array([3.705020320460961,3.6828964839656435,3.6607389234112993,3.6385642873840296,3.6874774064646063,3.6653377751568335,3.640792636600746,3.616186026342129,3.6627090061000245,3.6381540491470057,3.6136165945537346,3.5872576138861865,3.631999194931178,3.6057080892685063,3.579412501294192,3.553049251758412,3.594482246480767,3.5649333540274113,3.535391718650048,3.5057465632180773,3.5471229954363683,3.518494470973671,3.4898300880178317,3.4611232298230914,3.5033502340364606,3.474688839288383,3.445240905568696,3.415699697078156,3.4570865880236137,3.427624140151941,3.3981277547778292,3.366171007198632,3.405032649141889,3.373088921610797,3.341072623319774,3.3090642224349787,3.3490221097400226,3.3181453858233336,3.2872791206338112,3.2563223554377863,3.2961908099533854,3.26219119548212,3.2281903003503847,3.194143728328575,3.2308399868615263,3.1968378110693223,3.1615434488635157,3.126152823679095,3.161515914663424,3.1262185642498563,3.0908467220856526])
        
        expected_rhoSH = np.array([369627.7646606445,369637.3162109375,369646.60041503905,369655.6415771484,369625.35854492185,369635.00731201173,369643.7811279297,369652.48203124997,369621.54278564453,369630.5839477539,369639.5035888672,369647.7913208008,369616.6333374023,369625.5286743164,369634.1080566406,369642.44439697266,369614.9077392578,369623.8516845703,369632.3581542969,369640.47575683595,369610.94615478517,369619.5741455078,369627.934790039,369635.9794799805,369605.91518554685,369614.4216552734,369622.61217041017,369630.486730957,369600.22800292965,369608.4185180664,369616.4389038086,369624.046118164,369593.3985229492,369601.37030029297,369609.12333984376,369616.5361206055,369585.8642211914,369594.05473632814,369601.75916748046,369609.48790283204,369578.7430908203,369586.47182617185,369593.9089111328,369601.1515625,369569.8963623047,369577.6737060547,369585.03787841793,369592.11040039064,369560.90380859375,369568.60823974607,369576.19114990236])
        
        dates = np.array([dt.datetime(i,1,1) for i in np.arange(1965,2016)])
        
        lat = 60
        lon = 0
        rho = 60000
        trace = tsygTrace(lat = np.ones_like(dates) * lat,
                          lon = np.ones_like(dates) * lon,
                          rho = np.ones_like(dates) * rho,
                          coords = 'geo', datetime = dates)
                          
        unittest.assertEqual(trace.latNH, expected_latNH)
        unittest.assertEqual(trace.lonNH, expected_lonNH)
        unittest.assertEqual(trace.rhoNH, expected_rhoNH)
        unittest.assertEqual(trace.latSH, expected_latSH)
        unittest.assertEqual(trace.lonSH, expected_lonSH)
        unittest.assertEqual(trace.rhoSH, expected_rhoSH)
